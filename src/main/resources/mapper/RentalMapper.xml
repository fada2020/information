<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jp.co.info.ais.asm.mapper.RentalMapper">
	<select id="selectAll"
		resultType="jp.co.info.ais.asm.domain.Rental">




		SELECT a.asset_number,
		r.rental_seq,
		r.rental_day,
		r.rental_user_id,
		r.purpose,
		r.speciality,
		r.applicant_id,
		r.return_day,
		r.return_user_id,
		r.return_period,
		a.status_code,
		r.storage_Location,
		r.bp_Name
		FROM rental r

		JOIN asset a ON r.asset_seq = a.asset_seq

		AND a.status_code = '0' ORDER BY asset_number ASC

		<if test="rentDay != null">
		<![CDATA[
		AND r.rental_Day = DATE_FORMAT(#{rentalDay}, '%Y-%m-%d' )
		]]>
		</if>
		LIMIT #{length} OFFSET #{start}
	</select>

	<select id="selectCount" resultType="int">
		SELECT COUNT(1)
		FROM rental


	</select>

	<select id="getSelectData" parameterType="Integer"
		resultType="jp.co.info.ais.asm.domain.Rental">
		select p_s_num, p_name from product where
		p_c_num=#{pcNum}

	</select>

	<select id="getSelectProduct" parameterType="String"
		resultType="jp.co.info.ais.asm.domain.Rental">
		select p.p_s_num, i.assetnumber from itasset i
		join state s
		on s.s_number=i.s_number
		join product p on p.p_s_num=i.p_s_num
		where
		i.p_s_num=#{psNum} and i.s_number='1'

	</select>

	<select id="writeProduct" parameterType="String"
		resultType="java.util.HashMap">
		select assetNumber from itasset i where
		i.assetNumber=#{realCode}

	</select>



	<select id="searchCode"
		resultType="jp.co.info.ais.asm.domain.ProductKind">
		select p_c_num,p_c_name from productkind

	</select>

	<select id="researchRental" parameterType="String"
		resultType="jp.co.info.ais.asm.domain.Rental">
		select * from Rental
		where assetNumber=#{assetNumber}
	</select>
  <select id="selectStateCode" resultType="jp.co.info.ais.asm.domain.StateCode">
    	SELECT
    		code_detail_id,
    		code_detail_name
    	FROM code_detail where code_master_id='001'
    </select>

    <select id="selectProductCode" resultType="jp.co.info.ais.asm.domain.ProductCode">
     	SELECT
    		code_detail_id,
    		code_detail_name,
    		item1,
    		item2
    	FROM code_detail where code_master_id='002'
    </select>


</mapper>
