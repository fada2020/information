<div class="mmodal">
	<div class="modal-dialog modal-xl" style="width: 70%;" role="document">
		<div class="modal-content" role="main">
		<!--START modal-header -->
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">×</span>
				</button>
				<h3 class="modal-title"><i class="fa fa-pencil-square" aria-hidden="true" ></i> IT資産情報変更</h3>
			</div>
		<!--END modal-header -->
			<div class="row" style="width: 100%; margin-left: 0%">
			<!-- START modal-body -->
				<div class="modal-body">
					<div class="x_panel">
					<!-- START資産情報変更フォーム -->
						<form action="/asset/update" id="am_updateForm" method="POST"
							role="form" class="form-horizontal">
							<div class="x_content" style="display: block;">
								<div class="row well">
									<div class="col-md-6">
										<div class="row">
											<div class="col-md-2">
												<span>管理番号</span>
											</div>
											<div class="col-md-4">
												<input type="hidden" class="form-control" name="assetSeq" th:value="${asset.assetSeq}">
												<input type="text" class="form-control" name="assetNumber" th:value="${asset.assetNumber}" disabled>
											</div>
											<div class="col-md-2">
												<span>区分</span>
											</div>
											<div class="col-md-4">
												<select name="kubunCode" class="form-control" id="am_psNum_search">
													<option th:each="code : ${productCode}" th:value="${code.codeDetailId}" th:selected="${code.codeDetailId == asset.kubunCode}" th:inline="text">
														[[${code.codeDetailName}]]
													</option>
												</select>
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<div class="col-md-2">
												<span>購入日</span>
											</div>
											<div class="col-md-4">
													<div class="input-group date" id="am_myDatepicker">
														<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
														<input type="text" class="form-control input-group-addon" name="purchaseDate" th:value="${asset.purchaseDate}">
													</div>
											</div>
											<div class="col-md-2">
												<span>状態</span>
											</div>
											<div class="col-md-4">
												<input type="hidden" class="form-control" name="preStatusCode" th:value="${asset.statusCode}">
												<select name="statusCode" class="form-control" id="am_sNumber_search">
													<option th:each="code : ${stateCode}" th:value="${code.codeDetailId}" th:selected="${code.codeDetailId == asset.statusCode}" th:inline="text">
														[[${code.codeDetailName}]]
													</option>
												</select>
											</div>
										</div>
									</div>

									<div class="col-md-6">
										<div class="row">
											<div class="col-md-2">
												<span>購入先</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="buyTo" th:value="${asset.buyTo}">
											</div>
											<div class="col-md-2">
												<span>購入金額(円)</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control numVal" name="purchasePrice" th:value="${asset.purchasePrice}">
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<div class="col-md-2">
												<span>保管場所</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="storageLocation" th:value="${asset.storageLocation}">
											</div>
											<div class="col-md-2">
												<span>保証期間(年)</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control numVal" name="warrantyPeriod" th:value="${asset.warrantyPeriod}">
											</div>
										</div>
									</div>

									<div class="col-md-12">
										<br>
									</div>

									<div class="col-md-6">
										<div class="row">
											<div class="col-md-2">
												<span>メーカー</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="makerName" th:value="${asset.makerName}">
											</div>
											<div class="col-md-2">
												<span>モデル</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="modelName" th:value="${asset.modelName}">
											</div>
										</div>
									</div>
									<div class="col-md-6">
										<div class="row">
											<div class="col-md-2">
												<span>S/N</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="serialNum" th:value="${asset.serialNum}">
											</div>
											<div class="col-md-2">
												<span>I/F</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="interFaceCol" th:value="${asset.interFaceCol}">
											</div>
										</div>
									</div>
									<div class="col-md-12">
										<br> <span>その他</span>
									</div>
									<div class="col-md-12">
										<textarea class="form-control" name="other" th:text="${asset.other}"></textarea>
									</div>
								</div>
								<div class="x_panel">
									<div class="x_title">
										<div class="row">
											<h2>PC仕様詳細変更</h2>
											<ul class="nav navbar-right">
												<li><a class="collapse-link-update"><i class="fa fa-chevron-down"></i></a></li>
											</ul>
										</div>
									</div>
									<div class="x_content" style="display: none;">
										<div class="row well">
											<div class="col-md-12">
												<span>OS</span>
											</div>
											<div class="col-md-12">
												<br>
											</div>
											<div class="col-md-2">
												<span>名(Edition)</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="osName" th:value="${asset.osName}">
											</div>
											<div class="col-md-2">
												<span>Product Key</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="osProductKey" th:value="${asset.osProductKey}">
											</div>
										</div>
										<div class="row well">
											<div class="col-md-12">
												<span>CPU</span>
											</div>
											<div class="col-md-12">
												<br>
											</div>
											<div class="col-md-2">
												<span>Processor</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control" name="cpuProcessor" th:value="${asset.cpuProcessor}">
											</div>
											<div class="col-md-2">
												<span>動作周波数(㎓)</span>
											</div>
											<div class="col-md-4">
												<input type="text" class="form-control numVal" name="operatingFrequency" th:value="${asset.operatingFrequency}">
											</div>
										</div>
										<div class="row well">
											<div class="col-md-6">
												<div class="row well">
													<div class="col-md-12">
														<span>Memory(GB)</span>
													</div>
													<div class="col-md-12">
														<br>
													</div>
													<div class="col-md-4">
														<input type="text" class="form-control numVal" name="memory" th:value="${asset.memory}">
													</div>
													<div class="col-md-4">
														<span>Upgarde</span>
													</div>
													<div class="col-md-4">
														<input type="text" class="form-control numVal" name="memoryUpgarde" th:value="${asset.memoryUpgarde}">
													</div>
												</div>
											</div>
											<div class="col-md-6">
												<div class="row well">
													<div class="col-md-12">
														<span>HDD/SSD(GB)</span>
													</div>
													<div class="col-md-12">
														<br>
													</div>
													<div class="col-md-4">
														<input type="text" class="form-control numVal" name="hdd" th:value="${asset.hdd}">
													</div>
													<div class="col-md-4">
														<span>Upgarde</span>
													</div>
													<div class="col-md-4">
														<input type="text" class="form-control numVal" name="hddUpgarde" th:value="${asset.hddUpgarde}">
													</div>
												</div>
											</div>
										</div>
										<div class="row well">
											<div class="col-md-12">
												<span>MAC</span>
											</div>
											<div class="col-md-12">
												<br>
											</div>
											<div class="col-md-3">
												<span>LAN</span>
											</div>
											<div class="col-md-3">
												<input type="text" class="form-control" name="macLan" th:value="${asset.macLan}">
											</div>
											<div class="col-md-3">
												<span>Wireless</span>
											</div>
											<div class="col-md-3">
												<input type="text" class="form-control" name="macWireless" th:value="${asset.macWireless}">
											</div>
										</div>
										<div class="row well">
											<div class="col-md-12">
												<span>Security</span>
											</div>
											<div class="col-md-12">
												<br>
											</div>
											<div class="col-md-3">
												<span>BIOS</span>
											</div>
											<div class="col-md-3">
												<input type="text" class="form-control" name="securityBios" th:value="${asset.securityBios}">
											</div>
											<div class="col-md-3">
												<span>HDD</span>
											</div>
											<div class="col-md-3">
												<input type="text" class="form-control" name="securityHdd" th:value="${asset.securityHdd}">
											</div>
										</div>
										<div class="row well">
											<div class="col-md-12">
												<span>Admin.Account</span>
											</div>
											<div class="col-md-12">
												<br>
											</div>
											<div class="col-md-3">
												<span>ID</span>
											</div>
											<div class="col-md-3">
												<input type="text" class="form-control" name="adminAccountId" th:value="${asset.adminAccountId}">
											</div>
											<div class="col-md-3">
												<span>PW</span>
											</div>
											<div class="col-md-3">
												<input type="text" class="form-control" name="adminAccountPwd" th:value="${asset.adminAccountPwd}">
											</div>
										</div>
									</div>
								</div>
							</div>
						</form>
					<!-- END資産情報変更フォーム -->
						<div class="x_content" style="display: block;">
							<div class="col-md-12">
								<div class="x_title">
									<h2>付属品</h2>
									<div class="clearfix"></div>
								</div>
								<div class="x_content" style="display: block;">
									<div
										class="table-responsive table-wrapper-scroll-y my-custom-scrollbar-update">
									<!-- START付属品変更フォーム -->
										<form id="accForm">
											<table class="table table-striped jambo_table bulk_action text-center" id="am_table1">
												<thead>
													<tr class="headings">
														<th class="col-md-1">No</th>
														<th class="col-md-2">品名</th>
														<th class="col-md-2">仕樣</th>
														<th class="col-md-1">数量</th>
														<th class="col-md-6">備考</th>
														<th colspan="2"></th>
													</tr>
												</thead>
												<tbody>
												<!-- START付属品10個項目 -->
													<!-- START既存 付属品 -->
													<tr id="accupdate1" th:each="accessories, accnum : ${asset.accessoriesList}">
														<input type="hidden" th:id="${#ids.seq('am_acckey')}" th:value="${accessories.accessoriesSeq}">
														<td th:id="${#ids.seq('am_accessoriesSeq')}" th:text="${accnum.index+1}"></td>
														<td><input type="text" maxlength="25" th:name="${#ids.seq('accName')}" class="form-control" th:id="${#ids.seq('am_itemName')}" th:value="${accessories.itemName}"></td>
														<td><input type="text" maxlength="25" th:name="${#ids.seq('accSpec')}" class="form-control" th:id="${#ids.seq('am_itemSpec')}" th:value="${accessories.itemSpec}"></td>
														<td><input type="text" maxlength="3" th:name="${#ids.seq('accQuantity')}" class="form-control" th:id="${#ids.seq('am_itemQuantity')}" th:value="${accessories.itemQuantity}"></td>
														<td><input type="text" maxlength="100" th:name="${#ids.seq('accRemarks')}" class="form-control" th:id="${#ids.seq('am_remarks')}" th:value="${accessories.remarks}"></td>
													</tr>
													<!-- END既存 付属品 -->
													<!-- STATRT付属品を追加ため空欄 -->
													<tr id="accupdate2" th:if="${#lists.size(asset.accessoriesList) < 10}"
														th:each="index:${#numbers.sequence(1,10-#lists.size(asset.accessoriesList))}">
														<td th:id="${#ids.seq('am_accessoriesSeq')}" th:text="${index+#lists.size(asset.accessoriesList)}"></td>
														<td><input type="text" maxlength="25" class="form-control" th:name="${#ids.seq('accName')}" th:id="${#ids.seq('am_itemName')}"></td>
														<td><input type="text" maxlength="25" class="form-control" th:name="${#ids.seq('accSpec')}"th:id="${#ids.seq('am_itemSpec')}"></td>
														<td><input type="text" maxlength="3" class="form-control" th:name="${#ids.seq('accQuantity')}" th:id="${#ids.seq('am_itemQuantity')}"></td>
														<td><input type="text" maxlength="100" class="form-control" th:name="${#ids.seq('accRemarks')}" th:id="${#ids.seq('am_remarks')}"></td>
													</tr>
													<!-- END付属品を追加ため空欄 -->
												<!-- END付属品10個項目 -->
												</tbody>
											</table>
										</form>
										<!-- END付属品変更フォーム -->
									</div>
								</div>
							</div>
						</div>
						<!-- END付属品テーブル -->

						<div class="x_content" style="display: block;">
							<div class="col-md-12">
								<div class="x_title">
									<h2>故障・廃棄履歴</h2>
									<div class="clearfix"></div>
								</div>
								<div class="x_content" style="display: block;">
									<div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar-update">
									<!-- START故障・廃棄履歴変更フォーム -->
										<form id="mhForm">
											<table class="table table-striped jambo_table bulk_action" id="am_table2">
												<thead>
													<tr class="headings">
														<th class="col-md-1">No</th>
														<th class="col-md-2">実施日</th>
														<th class="col-md-5">実施内容</th>
														<th class="col-md-2">担当</th>
														<th class="col-md-2">承認</th>
														<th colspan="2"></th>
													</tr>
												</thead>
												<tbody>
												<!-- START故障・廃棄履歴10個項目 -->
													<!-- START既存 故障・廃棄履歴 -->
													<tr id="mhupdate1" th:each="maintenance, mhnum : ${asset.maintenanceHistoryList}">
														<input type="hidden" th:id="${#ids.seq('am_mhkey')}" th:value="${maintenance.historySeq}">
														<td th:id="${#ids.seq('am_historySeq')}" th:text="${mhnum.index+1}"></td>
														<td>
															<div class="input-group date mhDatepicker">
																<input type="text" class="form-control" maxlength="10" name="mhDate" th:id="${#ids.seq('am_implementationDate')}" th:value="${maintenance.implementationDate}">
															</div>
														</td>
														<td><input type="text" class="form-control" maxlength="100" name="mhDetail" th:id="${#ids.seq('am_implementationDetail')}" th:value="${maintenance.implementationDetail}"></td>
														<td><input type="text" maxlength="10" name="mhrepId" class="form-control" th:id="${#ids.seq('am_repId')}" th:value="${maintenance.repId}"></td>
														<td><input type="text" maxlength="10" name="mhapproverId" class="form-control" th:id="${#ids.seq('am_approverId')}" th:value="${maintenance.approverId}"></td>
													</tr>
													<!-- END既存 故障・廃棄履歴 -->
													<!-- START故障・廃棄履歴を追加ため空欄 -->
													<tr id="mhupdate2" th:if="${#lists.size(asset.maintenanceHistoryList) < 10}" th:each="index:${#numbers.sequence(1,10-#lists.size(asset.maintenanceHistoryList))}">
														<td th:id="${#ids.seq('am_historySeq')}" th:text="${index+#lists.size(asset.maintenanceHistoryList)}"></td>
														<td>
															<div class="input-group date mhDatepicker">
																<input type="text" class="form-control" maxlength="10" name="mhDate" th:id="${#ids.seq('am_implementationDate')}">
															</div>
														</td>
														<td><input type="text" class="form-control" maxlength="100" name="mhDetail" th:id="${#ids.seq('am_implementationDetail')}"></td>
														<td><input type="text" maxlength="10" name="mhrepId" class="form-control" th:id="${#ids.seq('am_repId')}"></td>
														<td><input type="text" maxlength="10" name="mhapproverId" class="form-control" th:id="${#ids.seq('am_approverId')}"></td>
													</tr>
													<!-- END故障・廃棄履歴を追加ため空欄 -->
												<!-- END故障・廃棄履歴10個項目 -->
												</tbody>
											</table>
										</form>
									<!-- END故障・廃棄履歴変更フォーム -->

									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			<!-- END modal-body -->
			<!-- START modal-footer -->
				<div class="modal-footer">
					<div class="col-md-12 text-left">
						<button type="button" class="btn btn-secondary pull-right" data-dismiss="modal">戻る</button>
						<button type="button" id="sisanupdate" class="btn btn-primary btn-warning">変更</button>
					</div>
				</div>
			<!-- END modal-footer -->
			</div>
		</div>
	</div>
</div>
	<!-- page script -->
	<script th:inline="javascript">
    /*<![CDATA[*/
		// collapse-link event
	    $('.collapse-link-update').on('click', function() {
	        var $BOX_PANEL = $(this).closest('.x_panel'),
	            $ICON = $(this).find('i'),
	            $BOX_CONTENT = $BOX_PANEL.find('.x_content');

	        // fix for some div with hardcoded fix class
	        if ($BOX_PANEL.attr('style')) {
	            $BOX_CONTENT.slideToggle(200, function(){
	                $BOX_PANEL.removeAttr('style');
	            });
	        } else {
	            $BOX_CONTENT.slideToggle(200);
	            $BOX_PANEL.css('height', 'auto');
	        }

	        $ICON.toggleClass('fa-chevron-up fa-chevron-down');
	    });
	    $('.close-link').click(function () {
	        var $BOX_PANEL = $(this).closest('.x_panel');
	        $BOX_PANEL.remove();
	    });
		// /collapse-link event

  	 	// datetimepicker format
   		$('#am_myDatepicker').datetimepicker({
   			format: 'YYYY-MM-DD'
		});	// 購入日

  		$('.mhDatepicker').datetimepicker({
			format: 'YYYY-MM-DD'

		});	// 故障・廃棄履歴の実施日

  		// /datetimepicker format

  		// 区分コードMap
	   	var productCodeMap = new Map();
		var productCode = /*[[${productCode}]]*/;
	   	productCode.forEach(function( value ) {
	   		productCodeMap.set(value.codeDetailId, value.codeDetailName);
	   	});
		// /区分コードMap

		// 状態コードMap
	   	var stateCodeMap = new Map();
	   	var stateCode = /*[[${stateCode}]]*/;
	   	stateCode.forEach(function( value ) {
	   		stateCodeMap.set(value.codeDetailId, value.codeDetailName);
	   	});
		// /状態コードMap

		// Jquery validator メッセージセッティング
	   	$.validator.messages.number = '数字入力';
	   	$.validator.messages.maxlength = '{0} 文字以下を入力';
		// /Jquery validator メッセージセッティング

		// 有効性検証
       $(function(){
       	// 数量文字入力制限
       	$('#am_table1 tbody').on('keyup','#am_itemQuantity', function() {
       	    if (/\D/.test(this.value)) {
       	        this.value = this.value.replace(/\D/g, '')
       	        alert('半角数字のみ入力');
       	    }
       	});

		// 実施日文字入力制限
       	$('#am_table2 tbody').on('keyup','#am_implementationDate', function() {
       	    if (/\D/.test(this.value)) {
       	        this.value = this.value.replace(/\D/g, '')
       	        alert('半角数字のみ入力');
       	    }
       	});

   		var assform = $('#am_updateForm');
   		var accform = $('#accForm');
		var mhform = $('#mhForm');
		// 資産変更モーダルの変更バトン
       	$('#sisanupdate').click(function(){
  			// 主要な資産の有効性検証
                  assform.validate({
                      rules: {
                      	kubunCode : {
                      		required : true
                      	},

                          statusCode: {
                          	required: true
                          },
                          warrantyPeriod: {
                          	number: true,
                          	maxlength: 2
                          },
                          buyTo: {
                          	maxlength: 15
                          },
                          storageLocation: {
                          	maxlength: 15
                          },
                          makerName: {
                          	maxlength: 25
                          },
                          modelName: {
                          	maxlength: 25
                          },
                          serialNum: {
                          	maxlength: 100
                          },
                          interFaceCol: {
                          	maxlength: 25
                          },
                          osName: {
                          	maxlength: 50
                          },
                          osProductKey: {
                          	maxlength: 50
                          },
                          cpuProcessor: {
                          	maxlength: 50
                          },
                          purchasePrice: {
                          	number: true,
                          	maxlength: 11
                          },
                          operatingFrequency: {
                          	number: true,
                          	maxlength: 7
                          },
                          memory: {
                          	number: true,
                          	maxlength: 7
                          },
                          memoryUpgarde: {
                          	number: true,
                          	maxlength: 7
                          },
                          hdd: {
                          	number: true,
                          	maxlength: 7
                          },
                          hddUpgarde: {
                          	number: true,
                          	maxlength: 7
                          },
                          macLan: {
                          	maxlength: 25
                          },
                          macWireless: {
                          	maxlength: 25
                          },
                          other: {
                          	maxlength: 100
                          },
                          securityBios: {
                          	maxlength: 25
                          },
                          securityHdd: {
                          	maxlength: 25
                          },
                          adminAccountId: {
                          	maxlength: 25
                          },
                          adminAccountPwd: {
                          	maxlength: 25
                          }
                      },
                      messages: {
                      	kubunCode : {
                      		required : "区分を選択"
                      	},

                          statusCode: {
                          	required: "状態を選択"
                          }
                      },
                      errorPlacement: function(error, element) {
                          if (element.attr("name") == "purchaseDate") {
                            error.insertAfter("#am_myDatepicker");
                          } else {
                            error.insertAfter(element);
                          }
                      }
                  });
  			// /主要な資産の有効性検証
  			// 付属品の有効性検証
			accform.validate({
         			rules: {
 	                    accQuantity1 : {
 	                    	number: true
 	                       	},
 	                    accQuantity2 : {
 	                    	number: true
 	                       	},
 	                    accQuantity3 : {
  	                    	number: true
   	                       	},
  	                    accQuantity4 : {
  	                    	number: true
  	                       	},
  	                    accQuantity5 : {
  	                    	number: true
  	                       	},
  	                    accQuantity6 : {
  	                    	number: true
  	                       	},
  	                    accQuantity7 : {
   	                    number: true
    	                       	},
  	                    accQuantity8 : {
  	                    	number: true
  	                       	},
  	                    accQuantity9 : {
  	                    	number: true
  	                       	},
	          	        accQuantity10 : {
 	                    	number: true
                     	}
                     }
         		 	});
				// /付属品の有効性検証
  				// 有効性検査成功時
				if (assform.valid() && accform.valid()) {
                  	// number基本値セッティング
                      assform.find('.numVal').each(function( ) {
                      	if($(this).val() == '') {
                      		$(this).val('0');
                      	}
                      });
				// 付属品の既存目録サイズ
	       		var acclength = Object.keys([[${asset.accessoriesList}]]).length;
	 	      	// 故障・廃棄履歴の既存目録サイズ

	       		var mhlength = Object.keys([[${asset.maintenanceHistoryList}]]).length;
				//　変更confirm
				if(confirm('資産情報を変更しますか。')){
	        		if(acclength < 1){
	        			accinsert();
	        		} else{
	        			accupdate(),accinsert();
	        		}
	        		if(mhlength < 1){
	        			mhinsert();
	        		} else{
	        			mhupdate(), mhinsert();
	        		}
	        		assupdate();
	        	} else{
	        		return false;
	        	}
			}
            // 有効性検査成功時
       	});
	// /資産変更モーダルの変更バトン

	// 主要な資産情報変更
       	function assupdate() {
       		// 送信
               $.ajax({
                   url: assform.attr('action'),
                   type: assform.attr('method'),
                   data: assform.serialize(),
                   success: function(result, textStatus, xhr) {
                   	if(result == 0){
                   		alert('エラーが発生しました。');
                   	}else{
                   		alert('変更されました。');
                   		location.href = '/asset';
                   	}
                   },
                   // 通信失敗時の処理
                   error: function(xhr, textStatus, error) {
                   	alert('通信失敗');
                   }
               });
       	}
	// /主要な資産情報変更

	// 付属品変更・削除プロセス
		function accupdate() {
			var selectTr1 = $(accupdate1);
			var acclength = Object.keys([[${asset.accessoriesList}]]).length;
			var accupdateList = new Array();
			// 各付属品のリスト処理FOR文
			for(var i = 1; i < acclength + 1 ; i++){
				var am_itemName = '#am_itemName'+i;
				var am_itemSpec = '#am_itemSpec'+i;
				var am_itemQuantity = '#am_itemQuantity'+i;
				var am_remarks = '#am_remarks'+i;
				var am_acckey = '#am_acckey'+i;
				var accessories ={
            			"assetSeq" : /*[[${asset.assetSeq}]]*/,
            			"accessoriesSeq" : selectTr1.find(am_acckey).val(),
            			"itemName" : selectTr1.find(am_itemName).val(),
            			"itemSpec" : selectTr1.find(am_itemSpec).val(),
            			"itemQuantity" : selectTr1.find(am_itemQuantity).val(),
            			"remarks" : selectTr1.find(am_remarks).val(),
            			"insertId" :  /*[[${session.id}]]*/ ,
            			"updateId" :  /*[[${session.id}]]*/
            	};
			// 付属品削除プロセス
				if(selectTr1.find(am_itemName).val() == "" && selectTr1.find(am_itemSpec).val() == ""
					&& selectTr1.find(am_itemQuantity).val() == "" && selectTr1.find(am_remarks).val() ==""){
                	var accessories ={
                			"assetSeq" : /*[[${asset.assetSeq}]]*/,
                			"accessoriesSeq" :  selectTr1.find(am_acckey).val()
                	};
                	$.ajax(/*[[@{/asset/deleteAccessories}]]*/ 'asset/deleteAccessories',
    					{
    						type: "POST",
    						dataType: "json",
    						contentType: 'application/JSON',
    						data : JSON.stringify(accessories)
    					}
                	)
    				.success(function(result) {
    					if(result == 0) {
    						alert('エラーが発生しました。');
    					} else {
    						selectTr1.remove();
    						alert('削除しました');
    					}
    				}).error(function(xhr, textStatus, error) {
                    	alert('通信失敗accdelete');
                    });
				}
				// /付属品削除プロセス
				// 付属品変更プロセス
				else{
					accupdateList.push(accessories);
           		}
				// /付属品変更プロセス

            };
            // /各付属品のリスト処理FOR文
            $.ajax(/*[[@{/asset/updateAccessories}]]*/ 'asset/updateAccessories',
					{
						type: "POST",
						dataType: "json",
						contentType: 'application/JSON',
						data : JSON.stringify(accupdateList)
					}
            	)
				.success(function(result) {
					if(result == 0) {
						alert('エラーが発生しました。');
					} else {

					}
				}).error(function(xhr, textStatus, error) {
                	alert('通信失敗:付属品変更');
                });
		}
		// /付属品変更・削除プロセス

		// 付属品登録プロセス
		function accinsert() {
            var selectTr2 = $(accupdate2);
        	var acclength = Object.keys([[${asset.accessoriesList}]]).length;
        	var accinsertList = new Array();
        	// 付属品登録処理FOR文
			for(var i = acclength+1; i < 11 ; i++){
				var am_accessoriesSeq = '#am_accessoriesSeq'+i;
				var am_itemName = '#am_itemName'+i;
				var am_itemSpec = '#am_itemSpec'+i;
				var am_itemQuantity = '#am_itemQuantity'+i;
				var am_remarks = '#am_remarks'+i;
				var accessories ={
            			"assetSeq" : /*[[${asset.assetSeq}]]*/,
            			"accessoriesSeq" : selectTr2.find(am_accessoriesSeq).text(),
            			"itemName" : selectTr2.find(am_itemName).val(),
            			"itemSpec" : selectTr2.find(am_itemSpec).val(),
            			"itemQuantity" : selectTr2.find(am_itemQuantity).val(),
            			"remarks" : selectTr2.find(am_remarks).val(),
            			"insertId" :  /*[[${session.id}]]*/ ,
            			"updateId" :  /*[[${session.id}]]*/
            	};
				// 全項目空きったら、付属品登録しない
				if(selectTr2.find(am_itemName).val() == "" && selectTr2.find(am_itemSpec).val() == ""
					&& selectTr2.find(am_itemQuantity).val() == "" && selectTr2.find(am_remarks).val() == ""){
					continue;
				}
				// /全項目空きったら、付属品登録しない
				// 付属品登録プロセス
				else{
					accinsertList.push(accessories);
				}
				if(JSON.stringify(accinsertList) == "[]"){

				} else{
					$.ajax(/*[[@{/asset/addAccessories}]]*/ 'asset/addAccessories',
	    					{
	    						type: "POST",
	    						dataType: "json",
	    						contentType: 'application/JSON',
	    						data : JSON.stringify(accinsertList)
	    					}
	                	)
	    				.success(function(result) {
	    					if(result == 0) {
	    						alert('エラーが発生しました。');
	    					} else {

	    					}
	    				}).error(function(xhr, textStatus, error) {
	                    	alert('通信失敗:付属品登録');
	                    });
				}
				// /付属品登録プロセス
            };
        	 // /付属品登録処理FOR文
		}
		// 付属品登録プロセス

		// 故障・廃棄履歴変更・削除プロセス
		function mhupdate() {
			var selectTr1 = $(mhupdate1);
			var mhlength = Object.keys([[${asset.maintenanceHistoryList}]]).length;
			var mhupdateList = new Array();
			// 故障・廃棄履歴変更・削除処理FOR文
			for(var i = 1; i < mhlength + 1 ; i++){
				var am_implementationDate = '#am_implementationDate'+i;
				var am_implementationDetail = '#am_implementationDetail'+i;
				var am_repId = '#am_repId'+i;
				var am_approverId = '#am_approverId'+i;
				var am_mhkey = '#am_mhkey'+i;

				var maintenanceHistory ={
            			"assetSeq" : /*[[${asset.assetSeq}]]*/,
            			"historySeq" : selectTr1.find(am_mhkey).val(),
            			"implementationDate" : selectTr1.find(am_implementationDate).val(),
            			"implementationDetail" : selectTr1.find(am_implementationDetail).val(),
            			"repId" : selectTr1.find(am_repId).val(),
            			"approverId" : selectTr1.find(am_approverId).val(),
            			"insertId" :  /*[[${session.id}]]*/ ,
            			"updateId" :  /*[[${session.id}]]*/
            	};
				// 保守削除プロセス
				if(selectTr1.find(am_implementationDate).val() == "" && selectTr1.find(am_implementationDetail).val() == ""
						&& selectTr1.find(am_repId).val() == "" && selectTr1.find(am_approverId).val() == ""){
                	var  maintenanceHistory ={
                			"assetSeq" : /*[[${asset.assetSeq}]]*/,
                			"historySeq" :  selectTr1.find(am_mhkey).val()
                	};

                	$.ajax(/*[[@{/asset/deleteMaintenanceHistory}]]*/ 'asset/deleteMaintenanceHistory',
    					{
    						type: "POST",
    						dataType: "json",
    						contentType: 'application/JSON',
    						data : JSON.stringify(maintenanceHistory)
    					}
                	)
    				.success(function(result) {
    					if(result == 0) {
    						alert('エラーが発生しました。');
    					} else {
    						selectTr1.remove();
    					}
    				}).error(function(xhr, textStatus, error) {
                    	alert('通信失敗mhdelete');
                    });
				}
				// /故障・廃棄履歴削除プロセス
				// 故障・廃棄履歴変更プロセス
				else{
					mhupdateList.push(maintenanceHistory);
           		}
				// /故障・廃棄履歴変更プロセス
            };
			// /故障・廃棄履歴変更・削除処理FOR文
			if(JSON.stringify(mhupdateList) == "[]"){

			} else{
				 $.ajax(/*[[@{/asset/updateMaintenanceHistory}]]*/ 'asset/updateMaintenanceHistory',
							{
								type: "POST",
								dataType: "json",
								contentType: 'application/JSON',
								data : JSON.stringify(mhupdateList)
							}
		            	)
						.success(function(result) {
							if(result == 0) {
								alert('エラーが発生しました。mhupdate');
							} else {

							}
						}).error(function(xhr, textStatus, error) {
		                	alert('通信失敗mhupdate');
		                });
			}

		}
		// /故障・廃棄履歴変更・削除プロセス

		// 故障・廃棄履歴登録プロセス
		function mhinsert() {
            var selectTr2 = $(mhupdate2);
        	var mhlength = Object.keys([[${asset.maintenanceHistoryList}]]).length;
			var mhinsertList = new Array();
            // 故障・廃棄履歴登録処理FOR文

			for(var i = mhlength+1; i < 11 ; i++){
				var am_historySeq = '#am_historySeq'+i;
				var am_implementationDate = '#am_implementationDate'+i;
				var am_implementationDetail = '#am_implementationDetail'+i;
				var am_repId = '#am_repId'+i;
				var am_approverId = '#am_approverId'+i;
				var  maintenanceHistory ={
            			"assetSeq" : /*[[${asset.assetSeq}]]*/,
            			"historySeq" : selectTr2.find(am_historySeq).text(),
            			"implementationDate" : selectTr2.find(am_implementationDate).val(),
            			"implementationDetail" : selectTr2.find(am_implementationDetail).val(),
            			"repId" : selectTr2.find(am_repId).val(),
            			"approverId" : selectTr2.find(am_approverId).val(),
            			"insertId" :  /*[[${session.id}]]*/ ,
            			"updateId" :  /*[[${session.id}]]*/
            	};
				if(selectTr2.find(am_implementationDate).val() == "" && selectTr2.find(am_implementationDetail).val() == ""
					&& selectTr2.find(am_repId).val() == "" && selectTr2.find(am_approverId).val() == ""){
					continue;
				} else{
					mhinsertList.push(maintenanceHistory);
				}

			}//for

			if(JSON.stringify(mhinsertList) == "[]"){

			} else{
				$.ajax(/*[[@{/asset/addMaintenanceHistory}]]*/ 'asset/addMaintenanceHistory',
	   					{
	   						type: "POST",
	   						dataType: "json",
	   						contentType: 'application/JSON',
	   						data : JSON.stringify(mhinsertList)
	   					}
	               	)
	   				.success(function(result) {
	   					if(result == 0) {
	   						alert('エラーが発生しました。mhinsert');
	   					} else {

	   					}
	   				}).error(function(xhr, textStatus, error) {
	                   	alert('通信失敗mhinsert');
	                   });//ajax end
			}

         // /故障・廃棄履歴登録処理FOR文
		}
		// /故障・廃棄履歴登録プロセス

      })
    /*]]>*/
    </script>

